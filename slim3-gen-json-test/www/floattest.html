<html>

<head>
<title>Number.MIN_VALUE - 利用可能な最小値を得る</title>
</head>

<body>

<script type="text/javascript">
mp2_32 = Math.pow(2, 32);
function getFrac(b8, b7, b6, b5, b4, b3, b2, b1){
       return b1 + (b2 << 8) + (b3 << 16) + ((b4 << 24) >>> 0) +
               ((b5 + (b6 << 8) + ((b7 & 0x0f) << 16)) * mp2_32);
}

function getAdjustedFrac(b8, b7, b6, b5, b4, b3, b2, b1){
       return b1 + (b2 << 8) + (b3 << 16) + ((b4 << 24) >>> 0) +
               ((b5 + (b6 << 8) + ((b7 & 0x0f) << 16)) * mp2_32) +
               0x10000000000000;
}

function readDouble(b8, b7, b6, b5, b4, b3, b2, b1){
       var frac =
               b1 + (b2 << 8) + (b3 << 16) + ((b4 << 24) >>> 0) +
               ((b5 + (b6 << 8) + ((b7 & 0x0f) << 16)) * mp2_32);
       var exp =
               ((b7 & 0xf0) >> 4) + ((b8 & 0x7f) << 4);
       var sign = (b8 & 0x80) != 0 ? -1 : 1;
       if(exp == 0){
               if(frac == 0) return (sign == 1) ? 0 : -0;
               return sign * frac * Math.pow(2, exp - 1022 - 52);
       }
       if(exp === 0x7ff){
               return frac != 0 ? NaN : (sign * Infinity);
       }
       return sign * (frac + 0x10000000000000) * Math.pow(2, exp - 1023 - 52);
}
function readDoubleProtobufjs(b8, b7, b6, b5, b4, b3, b2, b1){
	var precisionBits = 52;
	var exponentBits = 11;
	var buffer = new Array(b8, b7, b6, b5, b4, b3, b2, b1);
	var bias = Math.pow(2, exponentBits - 1) - 1, signal = (0x80 & b8) >> 7;//PROTO.BinaryParser.prototype.readBits.call(b,precisionBits + exponentBits, 1);
    var exponent = PROTO.BinaryParser.prototype.readBits.call(b,precisionBits, exponentBits), significand = 0;
    var divisor = 2;
    var curByte = b.buffer.length + (-precisionBits >> 3) - 1;
    var byteValue, startBit, mask;
    do
        for(byteValue = b.buffer[ ++curByte ], startBit = precisionBits % 8 || 8, mask = 1 << startBit;
            mask >>= 1; (byteValue & mask) && (significand += 1 / divisor), divisor *= 2){}
    while((precisionBits -= startBit));
    return exponent == (bias << 1) + 1 ? significand ? NaN : signal ? -Infinity : +Infinity
        : (1 + signal * -2) * (exponent || significand ? !exponent ? Math.pow(2, -bias + 1) * significand
        : Math.pow(2, exponent - bias) * (1 + significand) : 0);
        

document.write("<p>max: "+ Number.MAX_VALUE);
document.write("<br>min: "+ Number.MIN_VALUE);
document.write("<br>min*2: "+ (Number.MIN_VALUE * 2));
document.write("<br>min*4: "+ (Number.MIN_VALUE * 4));
document.write("<br>read max: "+ readDouble(0x7f, 0xef, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff));
document.write("<br>read min: "+ readDouble(0, 0, 0, 0, 0, 0, 0, 1));
document.write("<br>read min*2: "+ readDouble(0, 0, 0, 0, 0, 0, 0, 2));
document.write("<br>read min*4: "+ readDouble(0, 0, 0, 0, 0, 0, 0, 4));
document.write("<br>read min normal: "+ readDouble(0, 0x10, 0, 0, 0, 0, 0, 0));
document.write("<br>read NaN: "+ readDouble(0x7f, 0xf0, 0, 0, 0, 0, 0, 1));
document.write("<br>read +Infinity: "+ readDouble(0x7f, 0xf0, 0, 0, 0, 0, 0, 0));
document.write("<br>read -Infinity: "+ readDouble(0xff, 0xf0, 0, 0, 0, 0, 0, 0));
document.write("<br>read +0: "+ readDouble(0, 0, 0, 0, 0, 0, 0, 0));
document.write("<br>read -0: "+ ((readDouble(0x80, 0, 0, 0, 0, 0, 0, 0) === -0) ? "-0" : "0"));
document.write("<br>frac: "+ getFrac(0, 0, 0, 0, 0, 0, 0, 1));
document.write("<br>adjust: "+ 0x10000000000000);
document.write("<br>adjustedFrac: "+ getAdjustedFrac(0, 0, 0, 0, 0, 0, 0, 1) + '</p>');
</script>

</body>
</html>
